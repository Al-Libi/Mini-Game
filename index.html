<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mini Game</title>

<style>
:root{
  --bg:#0f1020;
  --panel:#161833;
  --tile:#1f2247;
  --text:#f6f6ff;
  --muted:#b9bbd6;
  --good:#53d769;
  --warn:#f7c948;
  --bad:#3a3d66;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  background: radial-gradient(1200px 800px at 20% 0%, #1b1d3f 0%, var(--bg) 55%);
  color:var(--text);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:16px;
}
.app{
  width:min(520px,100%);
  background: rgba(22,24,51,.85);
  border-radius:18px;
  padding:18px;
  box-shadow:0 20px 60px rgba(0,0,0,.45);
}
h1{margin:0;font-size:18px}
.sub{font-size:13px;color:var(--muted);margin-bottom:12px}

.grid{
  display:grid;
  grid-template-rows:repeat(6,1fr);
  gap:10px;
  max-width:420px;
  margin:0 auto 12px;
}
.row{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:10px;
}
.tile{
  height:62px;
  border-radius:12px;
  background:var(--tile);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:800;
  font-size:26px;
  text-transform:uppercase;
}
.tile.good{background:rgba(83,215,105,.35)}
.tile.warn{background:rgba(247,201,72,.35)}
.tile.bad{background:rgba(58,61,102,.9)}

.keyboard{
  display:grid;
  gap:8px;
  max-width:420px;
  margin:0 auto;
}
.kb-row{
  display:flex;
  gap:8px;
}
.key{
  flex:1;
  border:none;
  border-radius:12px;
  padding:12px 6px;
  background:rgba(255,255,255,.08);
  color:white;
  font-weight:800;
}
.key.wide{flex:1.35}

.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.65);
  display:none;
  align-items:center;
  justify-content:center;
}
.overlay.show{display:flex}
.modal{
  background:#161833;
  border-radius:18px;
  padding:18px;
  width:min(440px,100%);
  text-align:center;
  position:relative;
}

.question{
  font-size:22px;
  font-weight:900;
  margin-bottom:12px;
}
.btn-row{
  position:relative;
  display:flex;
  justify-content:center;
  gap:12px;
  min-height:60px;
}
.btn{
  padding:12px 16px;
  border-radius:14px;
  border:none;
  font-weight:900;
  cursor:pointer;
}
.btn.primary{
  background:linear-gradient(135deg,#53d769,#9ef5b2);
}
.btn.ghost{
  background:rgba(255,255,255,.1);
  color:white;
}

.yay{
  font-size:24px;
  font-weight:1000;
  margin-bottom:10px;
}
.photo{
  width:100%;
  border-radius:14px;
  margin-bottom:12px;
}

canvas{
  position:fixed;
  inset:0;
  pointer-events:none;
  display:none;
}
canvas.show{display:block}
</style>
</head>

<body>
<canvas id="confetti"></canvas>

<div class="app">
  <h1>Mini Game</h1>
  <div class="sub">Guess the 4-letter word</div>

  <div class="grid" id="grid"></div>
  <div class="keyboard" id="keyboard"></div>
</div>

<div class="overlay" id="overlay">
  <div class="modal">

    <!-- ASK SCREEN -->
    <div id="ask">
      <div class="question">Mezhgan, will you be my Valentine?</div>
      <div class="btn-row" id="btnRow">
        <button class="btn primary" id="yesBtn">YES</button>
        <button class="btn ghost" id="noBtn">NO</button>
      </div>
    </div>

    <!-- YAY SCREEN -->
    <div id="yay" style="display:none">
      <div class="yay">Yayyy i love you my beautiful kish mish ðŸ˜˜</div>
      <img src="IMG_5224.jpeg" class="photo" alt="Us together">
      <button class="btn ghost" onclick="reset()">Play again</button>
    </div>

  </div>
</div>

<script>
const ANSWER="DATE";
const rows=6, cols=4;
let r=0,c=0;
const letters=[...Array(rows)].map(()=>Array(cols).fill(""));
const status=[...Array(rows)].map(()=>Array(cols).fill(""));
const grid=document.getElementById("grid");
const kb=document.getElementById("keyboard");
const overlay=document.getElementById("overlay");
const ask=document.getElementById("ask");
const yay=document.getElementById("yay");
const noBtn=document.getElementById("noBtn");
const btnRow=document.getElementById("btnRow");

function build(){
  grid.innerHTML="";
  for(let i=0;i<rows;i++){
    const row=document.createElement("div");
    row.className="row";
    for(let j=0;j<cols;j++){
      const t=document.createElement("div");
      t.className="tile";
      row.appendChild(t);
    }
    grid.appendChild(row);
  }
}
function update(){
  [...grid.children].forEach((row,i)=>{
    [...row.children].forEach((t,j)=>{
      t.textContent=letters[i][j];
      t.classList.remove("good","warn","bad");
      if(status[i][j]) t.classList.add(status[i][j]);
    });
  });
}
const KB=[
["q","w","e","r","t","y","u","i","o","p"],
["a","s","d","f","g","h","j","k","l"],
["enter","z","x","c","v","b","n","m","back"]
];
function buildKB(){
  kb.innerHTML="";
  KB.forEach(rw=>{
    const r=document.createElement("div");
    r.className="kb-row";
    rw.forEach(k=>{
      const b=document.createElement("button");
      b.className="key"+((k==="enter"||k==="back")?" wide":"");
      b.textContent=k==="back"?"âŒ«":k;
      b.onclick=()=>key(k);
      r.appendChild(b);
    });
    kb.appendChild(r);
  });
}
function score(g){
  const a=ANSWER.split("");
  const res=Array(cols).fill("bad");
  const gg=g.split("");
  for(let i=0;i<cols;i++){
    if(gg[i]===a[i]){res[i]="good";a[i]=null;gg[i]=null;}
  }
  for(let i=0;i<cols;i++){
    if(gg[i]&&a.includes(gg[i])){
      res[i]="warn";a[a.indexOf(gg[i])]=null;
    }
  }
  return res;
}
function key(k){
  if(overlay.classList.contains("show")) return;
  if(k==="enter"){submit();return;}
  if(k==="back"&&c>0){c--;letters[r][c]="";status[r][c]="";update();return;}
  if(/^[a-z]$/.test(k)&&c<cols){letters[r][c]=k.toUpperCase();c++;update();}
}
function submit(){
  if(c<cols) return;
  const g=letters[r].join("");
  const res=score(g);
  for(let i=0;i<cols;i++) status[r][i]=res[i];
  update();
  if(g===ANSWER){win();return;}
  r++;c=0;
}
function win(){
  overlay.classList.add("show");
  ask.style.display="block";
  yay.style.display="none";
  teleportNo();
  startConfetti();
}
document.getElementById("yesBtn").onclick=()=>{
  ask.style.display="none";
  yay.style.display="block";
};
function teleportNo(){
  const move=()=>{
    noBtn.style.position="absolute";
    const p=btnRow.getBoundingClientRect();
    const b=noBtn.getBoundingClientRect();
    noBtn.style.left=Math.random()*(p.width-b.width)+"px";
    noBtn.style.top=Math.random()*(p.height-b.height)+"px";
  };
  noBtn.onmouseenter=move;
  noBtn.onclick=e=>{e.preventDefault();move();}
  setTimeout(move,150);
}
function reset(){
  overlay.classList.remove("show");
  r=0;c=0;
  letters.forEach(r=>r.fill(""));
  status.forEach(r=>r.fill(""));
  update();
  stopConfetti();
}
window.addEventListener("keydown",e=>{
  if(e.key==="Enter")key("enter");
  else if(e.key==="Backspace")key("back");
  else if(/^[a-zA-Z]$/.test(e.key))key(e.key.toLowerCase());
});

/* confetti */
const cv=document.getElementById("confetti"),ctx=cv.getContext("2d");
let pieces=[],run=false;
function startConfetti(){
  cv.width=innerWidth;cv.height=innerHeight;
  pieces=[...Array(150)].map(()=>({
    x:Math.random()*innerWidth,
    y:Math.random()*-innerHeight,
    s:5+Math.random()*5,
    vy:2+Math.random()*3,
    c:`hsl(${Math.random()*360},90%,60%)`
  }));
  cv.classList.add("show");run=true;tick();
}
function stopConfetti(){run=false;cv.classList.remove("show");}
function tick(){
  if(!run) return;
  ctx.clearRect(0,0,cv.width,cv.height);
  pieces.forEach(p=>{
    p.y+=p.vy;
    if(p.y>innerHeight)p.y=-20;
    ctx.fillStyle=p.c;
    ctx.fillRect(p.x,p.y,p.s,p.s);
  });
  requestAnimationFrame(tick);
}

build();buildKB();update();
</script>
</body>
</html>
